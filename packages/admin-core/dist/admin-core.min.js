/*!
 * admin-core.min.js v1.2.0
 * (c) 2019-2020 LiLiang
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).adminCore={})}(this,(function(e){"use strict";var n=function(e,t){return(e+"").length<t?n("0"+e,t):e},t=function(e,t){if(void 0===t&&(t="yyyy-MM-dd HH:mm:ss"),!e)return"";e instanceof Date||(e=new Date(e));var r=e.getFullYear(),o=e.getMonth()+1,u=e.getDate(),i=e.getDay(),c=e.getHours(),a=e.getMinutes(),d=e.getSeconds(),f=e.getMilliseconds(),l=e.getTimezoneOffset(),s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=["January","February","March","April","May","June","July","August","September","October","November","December"],g=m.map((function(e){return e.slice(0,3)})),p=s.map((function(e){return e.slice(0,3)}));return t.replace(/yyyy/g,(function(){return r})).replace(/yy/g,(function(){return(r+"").slice(2)})).replace(/MMMM/g,(function(){return m[o-1]})).replace(/MMM/g,(function(){return g[o-1]})).replace(/MM/g,(function(){return n(o,2)})).replace(/M/g,(function(){return o})).replace(/dddd/g,(function(){return s[i]})).replace(/ddd/g,(function(){return p[i]})).replace(/dd/g,(function(){return n(u,2)})).replace(/d/g,(function(){return u})).replace(/DD/g,(function(){return"0"+i})).replace(/D/g,(function(){return i})).replace(/HH/g,(function(){return n(c,2)})).replace(/H/g,(function(){return c})).replace(/hh/g,(function(){return n(c>12?c-12:c,2)})).replace(/h/g,(function(){return c>12?c-12:c})).replace(/mm/g,(function(){return n(a,2)})).replace(/m/g,(function(){return a})).replace(/ss/g,(function(){return n(d,2)})).replace(/s/g,(function(){return d})).replace(/SSS/g,(function(){return n(f,3)})).replace(/SS/g,(function(){return n(Math.round(f/10),2)})).replace(/S/g,(function(){return Math.round(f/100)})).replace(/A/g,(function(){return c>12?"PM":"AM"})).replace(/a/g,(function(){return c>12?"pm":"am"})).replace(/ZZ/g,(function(){return(l>0?"-":"+")+n(100*Math.floor(Math.abs(l)/60)+Math.abs(l)%60,4)}))},r=function(e,n){for(var t=e.$parent;t;){if(t.$options.name===n)return t;t=t.$parent}},o=function(e,n){return(n?e.$children.filter((function(e){return e.$options.name===n})):e.$children).reduce((function(e,t){return e.concat([t],t.$children.length?o(t,n):[])}),[])},u=function(e,n){for(var t=0,r="",o=0,u=e.length;o<u;o++){var i=e.charAt(o),c=t+i.replace(/[^\x00-\xff]/g,"**").length;if(c>n)return r;r+=i,t=c}return r},i=function(e){return e&&isNaN(e)?e:+e+"px"},c=function(e){return function(){return e.resolve("hash"===e.mode?location.hash.slice(1):location.pathname).route}},a=/^([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/,d=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,f=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\:([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/,l=function(e){void 0===e&&(e={});var n=e.trigger;void 0===n&&(n=null);var t=e.required;void 0===t&&(t=!0);var r=e.port,o=r?"（含端口号）":"",u=e.msg||"请输入IP地址"+o,i=e.regmsg||"请输入合法的IP地址"+o;return[{trigger:n,required:t,validator:function(n,o,c){o?(r?f:d).test(o)?e.remoteMethod?e.remoteMethod(n,o,c):c():c(new Error(i)):t?c(new Error(u)):c()}}]},s=function(e){void 0===e&&(e={});var n=e.trigger;void 0===n&&(n=null);var t=e.required;return void 0===t&&(t=!0),[{trigger:n,required:t,validator:function(n,r,o){r?a.test(r)?e.remoteMethod?e.remoteMethod(n,r,o):o():o(new Error(e.regmsg||"请输入合法的端口号")):t?o(new Error(e.msg||"请输入端口号")):o()}}]},m=Object.freeze({__proto__:null,formatDate:t,getParentComponent:r,getChildComponents:o,getSubStr:u,getRoute:c,getSize:i,createIpRule:l,createPortRule:s});var g=function(e,n){return e.forEach((function(e){var t=n?n+"/"+e.path:e.path;e.meta?e.meta.key=t:e.meta={key:t},e.children&&g(e.children,t)})),e},p=function(e,n){var t=function(r,o){var u=r.meta.permissionTag;u&&n.indexOf(u)<0?o?o.children.splice(o.children.indexOf(r),1,null):e.splice(e.indexOf(o),1):r.children&&(r.children.forEach((function(e){return t(e,r)})),r.children=r.children.filter((function(e){return e})))};return n&&e.forEach((function(e){return t(e)})),g(e)},h=function(e){var n=[],t=function(e,r){e.forEach((function(e){e.children;var o=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===n.indexOf(r)&&(t[r]=e[r]);return t}(e,["children"]);e.meta&&e.meta.notMenu||(r?r.children?r.children.push(o):r.children=[o]:n.push(o),e.children&&t(e.children,o))}))};return t(e),n},v=function(e,n,t){return function(r,o){return Promise.all(Object.keys(r).map((function(u,i){return function(r,o,u){return void 0===u&&(u=1e3),r().then((function(r){var i=r.default;("function"==typeof i&&(i=i({Vue:e,store:n,router:t})),i.store&&n.registerModule(i.name,i.store),i.routes&&(i.routes.forEach((function(e){e.meta?e.meta.index=u:e.meta={index:u}})),n.commit("core/ADD_MENUS",p(i.routes,o))),!n.state.homeComponent&&i.home&&i.home.component)&&((!i.home.permissionTag||o&&o.indexOf(i.home.permissionTag)>-1)&&n.commit("core/SET_HOME_COMPONENT",i.home.component))}))}(r[u],o,i).catch((function(){return console.log("模块: "+u+" 加载失败")}))})))}},M=function(e,n){var t=n.store,r=n.router;t.registerModule("core",function(e){return{namespaced:!0,state:{modal:{},routes:[],menus:[],homeComponent:null},mutations:{SHOW_MODAL:function(e,n){void 0===n&&(n={}),e.modal=Object.assign({},e.modal,n)},ADD_MENUS:function(n,t){e.addRoutes(t),n.routes=n.routes.concat(t),n.menus=n.menus.concat(h(t)),n.menus.sort((function(e,n){var t=e.meta.index,r=n.meta.index;return t>r?1:t<r?-1:0}))},SET_HOME_COMPONENT:function(e,n){e.homeComponent=n}},actions:{HIDE_ACTIVE_MODAL:function(e){var n=e.state,t=e.commit;return new Promise((function(e,r){var o,u=Object.keys(n.modal).filter((function(e){return n.modal[e]})),i=u.length;if(i)return t("SHOW_MODAL",((o={})[u[i-1]]=!1,o)),e();r()}))}}}}(r)),e.prototype.$adminCore=Object.assign({},m,{filterRoutes:p,getRoute:c(r),moduleLoader:v(e,t,r)})},y=function(e,n){var t,r;void 0===n&&(n="");var o="visible",u="onShow";return n&&(o=n.toLowerCase()+"Visible",u="on"+(n[0].toUpperCase()+n.slice(1).toLowerCase())+"Show"),{computed:(t={vnodeTag:function(){return this.$vnode.tag}},t[o]=function(){return this.$store.state.core.modal[this.vnodeTag]},t),methods:(r={},r[u]=function(e){var n;this.$store.commit("core/SHOW_MODAL",((n={})[this.vnodeTag]=e,n))},r)}};M.navModal=y,e.createIpRule=l,e.createPortRule=s,e.default=M,e.filterRoutes=p,e.formatDate=t,e.getChildComponents=o,e.getParentComponent=r,e.getRoute=c,e.getSize=i,e.getSubStr=u,e.navModal=y,Object.defineProperty(e,"__esModule",{value:!0})}));
