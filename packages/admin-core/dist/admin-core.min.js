/*!
 * admin-core.min.js v1.1.5
 * (c) 2019-2020 LiLiang
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).adminCore={})}(this,(function(e){"use strict";var n=function(e,t){return(e+"").length<t?n("0"+e,t):e},t=function(e,t){if(void 0===t&&(t="yyyy-MM-dd HH:mm:ss"),!e)return"";e instanceof Date||(e=new Date(e));var r=e.getFullYear(),o=e.getMonth()+1,u=e.getDate(),c=e.getDay(),i=e.getHours(),a=e.getMinutes(),f=e.getSeconds(),l=e.getMilliseconds(),s=e.getTimezoneOffset(),d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=["January","February","March","April","May","June","July","August","September","October","November","December"],p=m.map((function(e){return e.slice(0,3)})),h=d.map((function(e){return e.slice(0,3)}));return t.replace(/yyyy/g,(function(){return r})).replace(/yy/g,(function(){return(r+"").slice(2)})).replace(/MMMM/g,(function(){return m[o-1]})).replace(/MMM/g,(function(){return p[o-1]})).replace(/MM/g,(function(){return n(o,2)})).replace(/M/g,(function(){return o})).replace(/dddd/g,(function(){return d[c]})).replace(/ddd/g,(function(){return h[c]})).replace(/dd/g,(function(){return n(u,2)})).replace(/d/g,(function(){return u})).replace(/DD/g,(function(){return"0"+c})).replace(/D/g,(function(){return c})).replace(/HH/g,(function(){return n(i,2)})).replace(/H/g,(function(){return i})).replace(/hh/g,(function(){return n(i>12?i-12:i,2)})).replace(/h/g,(function(){return i>12?i-12:i})).replace(/mm/g,(function(){return n(a,2)})).replace(/m/g,(function(){return a})).replace(/ss/g,(function(){return n(f,2)})).replace(/s/g,(function(){return f})).replace(/SSS/g,(function(){return n(l,3)})).replace(/SS/g,(function(){return n(Math.round(l/10),2)})).replace(/S/g,(function(){return Math.round(l/100)})).replace(/A/g,(function(){return i>12?"PM":"AM"})).replace(/a/g,(function(){return i>12?"pm":"am"})).replace(/ZZ/g,(function(){return(s>0?"-":"+")+n(100*Math.floor(Math.abs(s)/60)+Math.abs(s)%60,4)}))},r=function(e,n){for(var t=e.$parent;t;){if(t.$options.name===n)return t;t=t.$parent}},o=function(e,n){return(n?e.$children.filter((function(e){return e.$options.name===n})):e.$children).reduce((function(e,t){return e.concat([t],t.$children.length?o(t,n):[])}),[])},u=function(e,n){for(var t=0,r="",o=0,u=e.length;o<u;o++){var c=e.charAt(o),i=t+c.replace(/[^\x00-\xff]/g,"**").length;if(i>n)return r;r+=c,t=i}return r},c=function(e){return e&&isNaN(e)?e:+e+"px"},i=function(e){return function(){return e.resolve("hash"===e.mode?location.hash.slice(1):location.pathname).route}},a=Object.freeze({__proto__:null,formatDate:t,getParentComponent:r,getChildComponents:o,getSubStr:u,getRoute:i,getSize:c});var f=function(e,n){return e.forEach((function(e){var t=n?n+"/"+e.path:e.path;e.meta?e.meta.key=t:e.meta={key:t},e.children&&f(e.children,t)})),e},l=function(e,n){void 0===n&&(n=[]);var t=function(r,o){var u=r.meta.permissionTag;u&&n.indexOf(u)<0?o?o.children.splice(o.children.indexOf(r),1,null):e.splice(e.indexOf(o),1):r.children&&(r.children.forEach((function(e){return t(e,r)})),r.children=r.children.filter((function(e){return e})))};return e.forEach((function(e){return t(e)})),f(e)},s=function(e){var n=[],t=function(e,r){e.forEach((function(e){e.children;var o=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===n.indexOf(r)&&(t[r]=e[r]);return t}(e,["children"]);e.meta&&e.meta.notMenu||(r?r.children?r.children.push(o):r.children=[o]:n.push(o),e.children&&t(e.children,o))}))};return t(e),n},d=function(e,n,t){return function(r,o){return Promise.all(Object.keys(r).map((function(u,c){return function(r,o,u){return void 0===u&&(u=1e3),r().then((function(r){var c=r.default;("function"==typeof c&&(c=c({Vue:e,store:n,router:t})),c.store&&n.registerModule(c.name,c.store),c.routes&&(c.routes.forEach((function(e){e.meta?e.meta.index=u:e.meta={index:u}})),n.commit("core/ADD_MENUS",l(c.routes,o))),!n.state.homeComponent&&c.home&&c.home.component)&&((!c.home.permissionTag||o&&o.indexOf(c.home.permissionTag)>-1)&&n.commit("core/SET_HOME_COMPONENT",c.home.component))}))}(r[u],o,c).catch((function(){return console.log("模块: "+u+" 加载失败")}))})))}},m=function(e,n){var t=n.store,r=n.router;t.registerModule("core",function(e){return{namespaced:!0,state:{modal:{},routes:[],menus:[],homeComponent:null},mutations:{SHOW_MODAL:function(e,n){void 0===n&&(n={}),e.modal=Object.assign({},e.modal,n)},ADD_MENUS:function(n,t){e.addRoutes(t),n.routes=n.routes.concat(t),n.menus=n.menus.concat(s(t)),n.menus.sort((function(e,n){var t=e.meta.index,r=n.meta.index;return t>r?1:t<r?-1:0}))},SET_HOME_COMPONENT:function(e,n){e.homeComponent=n}},actions:{HIDE_ACTIVE_MODAL:function(e){var n=e.state,t=e.commit;return new Promise((function(e,r){var o,u=Object.keys(n.modal).filter((function(e){return n.modal[e]})),c=u.length;if(c)return t("SHOW_MODAL",((o={})[u[c-1]]=!1,o)),e();r()}))}}}}(r)),e.prototype.$adminCore=Object.assign({},a,{filterRoutes:l,getRoute:i(r),moduleLoader:d(e,t,r)})},p=function(e,n){var t,r;void 0===n&&(n="");var o="visible",u="onShow";return n&&(o=n.toLowerCase()+"Visible",u="on"+(n[0].toUpperCase()+n.slice(1).toLowerCase())+"Show"),{computed:(t={},t[o]=function(){return this.$store.state.core.modal[e]},t),methods:(r={},r[u]=function(n){var t;this.$store.commit("core/SHOW_MODAL",((t={})[e]=n,t))},r)}};m.navModal=p,e.default=m,e.filterRoutes=l,e.formatDate=t,e.getChildComponents=o,e.getParentComponent=r,e.getRoute=i,e.getSize=c,e.getSubStr=u,e.navModal=p,Object.defineProperty(e,"__esModule",{value:!0})}));
